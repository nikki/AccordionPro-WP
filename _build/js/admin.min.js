jQuery(function(a){var b=a(".ap-slides"),c="undefined"!=typeof tinyMCE?+tinyMCE.majorVersion:3,d=3>=c?"Control":"Editor",e={initEditor:function(b,c){var e=jQuery.extend(!0,{},tinyMCEPreInit.mceInit.apeditor1);e.elements="apeditor"+(c+1),e.selector="#"+e.elements,e.height="172",a("#ap-add").before(b),tinyMCE.init(e),quicktags({id:e.elements}),QTags._buttonsInit(),tinyMCE.execCommand("mceAdd"+d,!1,e.elements),a("#ap-add").prev().slideDown()},addSlide:function(){var c=this,d=a(".ap-slides .ap-wait"),e=!1;d.ajaxStart(function(){d.css("display","inline-block")}),d.ajaxStop(function(){d.css("display","none")}),b.on("click","#ap-add",function(){var b=parseInt(a(".ap-slide-num").last().val(),10);e||(e=!0,a.post(ajaxurl,{action:"admin_slide_tmpl",data:{slideNum:b}},function(a){c.initEditor(a,b),c.initColourPicker(),c.initIconPicker(),e=!1}))})},removeSlide:function(){b.on("click",".ap-remove",function(){var b=a(this),c=+b.next().val();confirm(b.attr("data-confirm"))&&(tinyMCE.execCommand("mceRemove"+d,!1,"apeditor"+c),b.parent().parent().slideUp(function(){a(this).remove()}))})},toggleSlide:function(c){b.on("click",".ap-toggle",function(){a(this).parent().toggleClass("inactive")})},toggleCaption:function(){b.on("click",".ap-slide-caption-checkbox",function(){var b=a(this).prev().prev();b.hasClass("disabled")?b.removeClass("disabled"):b.addClass("disabled")}),b.on("focus",".ap-slide-caption-input",function(){var b=a(this);b.hasClass("disabled")&&(b.removeClass("disabled"),b.next().next().attr("checked",!0))}),b.on("blur",".ap-slide-caption-input",function(){var b=a(this);b.val()||(b.next().next().removeAttr("checked"),b.addClass("disabled"))})},switchOrientation:function(){var b=function(){var b=a("#orientation").val();"horizontal"===b?a("#Vertical-Accordion-Options").slideUp(function(){a("#Horizontal-Accordion-Options").slideDown()}):a("#Horizontal-Accordion-Options").slideUp(function(){a("#Vertical-Accordion-Options").slideDown()})};a(window).on("load",b),a("#orientation").on("change",b)},switchEditor:function(){b.on("click",".ajax .wp-switch-editor",function(){var b=a(this),d=b.attr("class").split(" ")[1].split("-")[1],e=b.parent().parent(),f=a(this).data("wp-editor-id");c>=4&&(e=e.parent()),f?window.switchEditors.go(f,d):switchEditors.switchto(this),e.removeClass().addClass("ap-inner "+d+"-active")})},addMedia:function(){b.on("click",".ajax .add-media",function(a){var b=this.id.split("-")[0];wpActiveEditor=b,3>=c&&tb_show("","media-upload.php?post_id=0&amp;TB_iframe=1&amp;width=640&amp;height=576"),a.preventDefault()})},initColourPicker:function(){var b=a(".color-picker");b.iris({palettes:["#ffffff","#c25252","#ca9859","#96ba5f","#59abb7","#bb6098"],change:function(b,c){var d=a(this);d.add(d.prev().children()).css({"background-color":c.color.toString()})}}).on("click",function(b){a(this).iris("show")}).prev().on("click",function(b){a(this).next().iris("show"),b.preventDefault()}).end().next().on("mouseleave",function(b){a(this).prev().iris("hide")}).parent().on("click",".iris-palette:eq(0)",function(b){a(b.delegateTarget).children("input").val("").css("background","none")}).find(".iris-palette:eq(0)").addClass("dashicons dashicons-no")},initIconPicker:function(){var b=a(".ap-inner .icon-wrapper button"),c=a(".ap-inner .icon-preview");b.on("click",function(b){var c=a(this),d=wp.media({title:"Select image",multiple:!1}).on("select",function(){var a=d.state().get("selection").first().toJSON().url;c.next().val(a).next().css("background-image","url('"+a+"')").addClass("active")}).open();b.preventDefault()}),c.on("click",function(b){a(this).css("background-image","").removeClass("active").prev().val("")})},initClipboardCopy:function(){var b=a(".ap-overview .ap-clipboard");b.length&&b.on("click",function(b){a(this).prev().select();try{var c=document.execCommand("copy");alert(c?"Copied text to clipboard.":"Copy to clipboard not currently supported in this browser.")}catch(d){alert("Copy to clipboard not currently supported in this browser.")}document.getSelection().removeAllRanges(),b.preventDefault()})},removeAccordion:function(){var b=a(".ap-del-acc");b.length&&b.on("click",function(b){return confirm(a(this).attr("data-confirm"))?!0:!1})},showTooltip:function(){a(".ap-options .postbox").not(":eq(0)").find("label span").on({mouseenter:function(){a(this).parent().next().show()},mouseleave:function(){a(this).parent().next().hide()}})},subscribeToNewsletter:function(){function b(a){c.next().empty().html(a).fadeIn()}var c=a("#ap-newsletter");c.length&&c.on("submit",function(d){a.getJSON(this.action+"?callback=?",a(this).serialize(),function(d){200===d.Status?(c.add(c.prev()).fadeOut(function(){b('<b style="color:green">Success! </b>'+d.Message)}),a.post(ajaxurl,{action:"set_newsletter_subscribed"})):b('<b style="color:darkred">Error: </b>'+d.Message)}),d.preventDefault()})},init:function(){this.addSlide(),this.removeSlide(),this.toggleSlide(),this.toggleCaption(),this.switchOrientation(),this.switchEditor(),this.addMedia(),this.initColourPicker(),this.initIconPicker(),this.showTooltip(),this.removeAccordion(),this.initClipboardCopy(),this.subscribeToNewsletter()}};e.init()});